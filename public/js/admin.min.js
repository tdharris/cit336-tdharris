(function(){Dropzone.autoDiscover=false;var spinMe=document.querySelectorAll("div .content")[0];var spinOptions={lines:13,length:20,width:10,radius:30,corners:1,rotate:0,direction:1,color:'#000',speed:1,trail:60,shadow:false,hwaccel:false,zIndex:2e9,top:'50%',left:'50%'};var dz_addPics=new Dropzone("div#addPics",{url:"lib/upload.php",acceptedFiles:"image/*",autoProcessQueue:false,uploadMultiple:true,parallelUploads:100,addRemoveLinks:true,maxFiles:10,init:function(){var myDropzone=this;var addForm=document.getElementById("addProject");var spinner=new Spinner(spinOptions);$("#addProject input[type=submit]").on("click",function(e){e.preventDefault();e.stopPropagation();spinner.spin(spinMe);spinMe.classList.toggle("blur");if(checkform(addForm)){if(!myDropzone.getQueuedFiles().length>0){toastr.warning('Please select an image.','Warning')}else{myDropzone.processQueue()}}});this.on("successmultiple",function(file,res){var addForm=document.getElementById("addProject");var projectName=$('#addProject input[name=projectName]').val();$.ajax({type:'POST',url:'lib/controllers/admin/addProject.php',data:($("#addProject").serialize()+'&'+$.param({'fileIDs':res})),dataType:'json',success:function(response){updateSelects("add",projectName);myDropzone.removeAllFiles();addForm.reset.click();spinMe.classList.toggle("blur");spinner.stop();toastr.success(response,'Success')},error:function(res){myDropzone.removeAllFiles();spinMe.classList.toggle("blur");spinner.stop();console.log(res);toastr.error(res.responseText,'Error!')}})});document.querySelector("#addProject input[name=reset]").addEventListener("click",function(){myDropzone.removeAllFiles()})}});$('#deleteProject').submit(function(event){event.preventDefault();event.stopPropagation();var deleteForm=document.getElementById("deleteProject");var projectName=$('#deleteProject select :selected').val();var spinner=new Spinner(spinOptions).spin(spinMe);spinMe.classList.toggle("blur");$.ajax({type:'POST',url:'lib/controllers/admin/deleteProject.php',data:$(this).serialize(),dataType:'json',success:function(response){updateSelects("remove",projectName);spinMe.classList.toggle("blur");spinner.stop();toastr.success(response,'Success')},error:function(res){spinMe.classList.toggle("blur");spinner.stop();toastr.error(res.responseText,'Error!')}})});$('#editProject').submit(function(event){event.preventDefault();event.stopPropagation();var editForm=document.getElementById("#editProject");var spinner=new Spinner().spin(spinMe);spinMe.classList.toggle("blur");$.ajax({type:'POST',url:'lib/controllers/admin/editProject.php',data:$(this).serialize(),dataType:'json',success:function(response){spinMe.classList.toggle("blur");spinner.stop();toastr.success(response,'Success')},error:function(res){spinMe.classList.toggle("blur");spinner.stop();toastr.error(res.responseText,'Error!')}})});function checkform(form){var inputs=form.getElementsByTagName('input');for(var i=0;i<inputs.length;i++){if(inputs[i].hasAttribute("required")){if(inputs[i].value==""){toastr.warning('Please fill all required fields.','Warning');return false}}}return true};function updateSelects(action,projectName){var selects=$("select[name=projectName]");if(action==="add"){$.each(selects,function(index,item){var newOptEl=document.createElement("OPTION");newOptEl.text=projectName;item.appendChild(newOptEl);item.value=projectName})}else if(action==="remove"){$.each(selects,function(index,item){var options=$(item).find("option");$.each(options,function(index,item){if(item.innerText==projectName)item.remove()})})}}})();